# This script automates system updates in Arch Linux

# Call the update-reflector script to get the best mirrors
/usr/bin/sudo /scr/update-reflector "United States"

# Build command to execute
cmd="/usr/bin/sudo /usr/bin/pacman -Syu"

# If local shared cache exists, use it
[[ -d /mnt/nfs/pacman/pkg ]] && cmd+=" --cachedir /mnt/nfs/pacman/pkg"

# Execute command
eval $cmd

# Check /usr/bin/init
if [ -e /usr/bin/init-kexec ]; then
  /usr/bin/sudo /usr/bin/diff -qs /usr/bin/init /usr/bin/init-kexec
  if [ $? != 0 ]; then
    /usr/bin/sudo /usr/bin/rm /usr/bin/init
    /usr/bin/sudo /usr/bin/cp /usr/bin/init-kexec /usr/bin/init
    echo "Replaced /usr/bin/init"
  fi
fi
